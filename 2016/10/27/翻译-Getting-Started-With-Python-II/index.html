<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="Getting Started with Pandas: Kaggle’s Titanic Competition开始使用Pandas：Kaggle’s Titanic Competition
To recap the last tutorial: we got comfortable with Python for re-implementing the models we originally">
<meta property="og:type" content="article">
<meta property="og:title" content="翻译 | Getting Started With Python II">
<meta property="og:url" content="http://yoursite.com/2016/10/27/翻译-Getting-Started-With-Python-II/index.html">
<meta property="og:site_name" content="ProgramLife">
<meta property="og:description" content="Getting Started with Pandas: Kaggle’s Titanic Competition开始使用Pandas：Kaggle’s Titanic Competition
To recap the last tutorial: we got comfortable with Python for re-implementing the models we originally">
<meta property="og:updated_time" content="2016-10-31T10:17:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="翻译 | Getting Started With Python II">
<meta name="twitter:description" content="Getting Started with Pandas: Kaggle’s Titanic Competition开始使用Pandas：Kaggle’s Titanic Competition
To recap the last tutorial: we got comfortable with Python for re-implementing the models we originally">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/2016/10/27/翻译-Getting-Started-With-Python-II/"/>

  <title> 翻译 | Getting Started With Python II | ProgramLife </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?cb10f5fafcabdf4c0137f311c0ecaf7b";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">ProgramLife</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                翻译 | Getting Started With Python II
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-27T09:09:49+08:00" content="2016-10-27">
              2016-10-27
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/27/翻译-Getting-Started-With-Python-II/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/27/翻译-Getting-Started-With-Python-II/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Getting Started with Pandas: Kaggle’s Titanic Competition<br>开始使用Pandas：Kaggle’s Titanic Competition</p>
<p>To recap the last tutorial: we got comfortable with Python for re-implementing the models we originally imagined in Excel. By using a programming language, we were able to (1) use more powerful constructs and methods, like arrays to store and retrieve variables, and (2) to write scripted steps that can be repeated in the future without us performing the work by hand.<br>简要回顾上一个教程：我们已经能轻松使用Python重新应用最初在Excel里构想的模型。通过使用编程语言，我们可以（1）使用更强大的结构体和方法；像能够存放和检索变量的数组；(2)写下在将来能复用的脚本步骤，以后就不用手动去执行了。<a id="more"></a></p>
<p>However, you may be thinking that you found it easier to understand what’s in the data back when you were using Excel. (When you wanted to see a column, you just scrolled over to look at it, rather than counting through the indices 0 to 8.) On the other hand, you might have statistics friends who tell you that life is better with the software R, which has the concept of a “data.frame”.  Well, in this third tutorial we will take a slight detour from our modeling work in order to bridge that gap.<br>然而，你发现当你使用Excel时理解data back更容易，（当你想看一列，你只需滚动鼠标查看，而不是从0到8计算索引。）另一方面，你也许有统计学朋友告诉你，用R软件更容易，它有一个data.frame的概念。在这第三个教程中，我们将从我们的建模工作里饶一点弯路，来弥合差距。</p>
<p>Python has another great package called Pandas, which makes data exploration and data cleaning much easier to do than manipulating arrays. It also lets you write code that’s easier to read. Pandas has the concept of a DataFrame, too, which is like a spreadsheet with more programmatic power. Finally, if you go searching for additional tutorials in the forums someday, you’ll often find that the author uses Pandas.<br>Python有另一个很好的包叫Pandas，它使数据探索和数据清理比操纵数组更方便。它也能让你写下更易读的代码。Pandas也有一个DataFrame的概念。这个概念像是一个有更多编程能力的电子制表软件。最后，如果某天你去论坛搜索额外的教程，你会经常发现作者使用Pandas。</p>
<p>This tutorial is a little different than the first two: this is not a cohesive script to be run, nor part of a sample .py found on the Data Page. Instead, this tutorial is meant to entered line by line on your python command line, so that you can learn some of the methods at your disposal and see what occurs. You might even deviate from this tutorial with other variables that interest you. Finally, at times the output from your command will be very long-winded, so not everything is printed in its entirety here.<br>这个教程与前两个有点不同：这不是用来运行的紧密结合的脚本，也不是在Data Page上找到的sample.py的部分。相反，这个教程用于在你的python命令行里一行一行的输入，这样你能在你的处理上学到一些方法，看看什么会发生。你也许会被其他变量吸引而脱离这个教程。最后，有时这些从你的指令得到的输出很啰嗦。所以这里不会打印所有输出。</p>
<p>Ready? If you have it installed, this would be a great time to utilize  ipython  or ipython notebook. Otherwise, run  python.<br>准备好了吗？你已经安装了它，这将有很多时间使用ipython或者ipython notebook。否则，使用python。</p>
<p>Numpy Arrays<br>Numpy数组</p>
<p>Let’s review what our train.csv data looked like in python up to this point. Run the following to load the data again:<br>到此为止，让我们回顾下我们train.csv在python里看起来是怎么样的。运行下列指令来重新装载数据：</p>
<pre><code>import csv as csv
import numpy as np

csv_file_object = csv.reader(open(&apos;../csv/train.csv&apos;, &apos;rb&apos;))
header = csv_file_object.next()
data=[]

for row in csv_file_object:
    data.append(row)
data = np.array(data)
</code></pre><p>Now type  print data<br>现在输入 print data</p>
<pre><code>[[&apos;1&apos; &apos;0&apos; &apos;3&apos; ..., &apos;7.25&apos; &apos;&apos; &apos;S&apos;]
[&apos;2&apos; &apos;1&apos; &apos;1&apos; ..., &apos;71.2833&apos; &apos;C85&apos; &apos;C&apos;]
[&apos;3&apos; &apos;1&apos; &apos;3&apos; ..., &apos;7.925&apos; &apos;&apos; &apos;S&apos;]
...,
[&apos;889&apos; &apos;0&apos; &apos;3&apos; ..., &apos;23.45&apos; &apos;&apos; &apos;S&apos;]
[&apos;890&apos; &apos;1&apos; &apos;1&apos; ..., &apos;30&apos; &apos;C148&apos; &apos;C&apos;]
[&apos;891&apos; &apos;0&apos; &apos;3&apos; ..., &apos;7.75&apos; &apos;&apos; &apos;Q&apos;]]
</code></pre><p>This is familiar… an array of strings that the csv package was able to read.<br>这是类似的，一个csv包能够读的字符串数组。<br>Look at the first 15 rows of the Age column:   data[0:15,5]<br>看看年龄列的前15行：  data[0:15,5]</p>
<pre><code>array([&apos;22&apos;, &apos;38&apos;, &apos;26&apos;, &apos;35&apos;, &apos;35&apos;, &apos;&apos;, &apos;54&apos;, &apos;2&apos;, &apos;27&apos;, &apos;14&apos;, &apos;4&apos;, &apos;58&apos;, &apos;20&apos;, &apos;39&apos;, &apos;14&apos;],
dtype=&apos;|S82&apos;)
</code></pre><p>Great, that command gives just the ages, and they are still stored as strings. What type of object is this whole column, though?<br>很好，这些指令只给了年龄，它们仍是以字符串的形式存储。然而，整列的object类型是什么？</p>
<p> type(data[0::,5])</p>
<pre><code>numpy.ndarray
</code></pre><p>So, any slice we take from the data is still a Numpy array. Now let’s see if we can take the mean of the passenger ages. They will need to be floats instead of strings, so set this up as:<br>所以，我们从这个data上取下的任意小份仍是Numpy 数组。现在让我们看看是否能够取得乘客年龄的平均值。它们应当是浮点型而非字符型，所以设置：</p>
<p>  ages_onboard = data[0::,5].astype(np.float)</p>
<pre><code>ValueError: could not convert string to float:
</code></pre><p>Hmm. This seemed to be working for the first few rows, but then produced an error when numpy got to the missing value ‘ ‘ in the 6th row. There is surely a way to use Python to filter out the missing values, then convert to float, then take the mean – but this isn’t sounding easy anymore. So let’s try again with Pandas.<br>嗯，这看起来对前几行有用，但当numpy在第六行得到缺失值时产生了一个错误。当然有办法是：使用Python过滤缺失值，然后转换为浮点型，再找均值——但这听起来不再那么容易。所以让我们用Pandas试试。</p>
<p>Pandas DataFrame</p>
<p>The first thing we have to do is import the Pandas package. It turns out that Pandas has its own functions to read or write a .csv file, so we are no longer actually using the csv package in the commands below. Let’s create a new object called ‘df’ for storing the pandas version of train.csv. (This means you can still refer to the original ‘data’ numpy array for the rest of this tutorial anytime you want to compare and contrast.)<br>第一件事我们必须做的，就是导入Pandas包。Pandas有它自己读和写.csv文件的功能，所以我们不再在以下指令中实际使用csv包。让我们创建一个新的object叫“df”来存储train.csv的pandas版本（这意味着在剩下的教程里，在任何你想比较和对比时，你仍能够参考初始的‘data’ numpy数组。）</p>
<pre><code>import pandas as pd
import numpy as np

# For .read_csv, always use header=0 when you know row 0 is the header row
df = pd.read_csv(&apos;train.csv&apos;, header=0)
</code></pre><p>Now look at what’s there by typing:<br>现在输入df看看那里有什么：</p>
<p> df</p>
<pre><code>(...long list of stuff...!)
...
...
...
891 rows × 12 columns
</code></pre><p>That wasn’t so helpful. So let’s look at just the first few rows:<br>这没有帮助，所以让我们仅看前面几行：</p>
<p> df.head(3)</p>
<pre><code>·(a short list of stuff!)
...
3 rows × 12 columns
</code></pre><p>You notice it has column names, and it has the index of rows labelled down the side. (Note: you can also try  df.tail(3) and you can feed it any number of rows.) Now, compared to the original data array, what kind of object is this?<br>你注意到它有列名字，有杭索引标在旁边（注意：你也可以试下df.tail(3),你能够用任何行数来填充）。现在对比下原始数据组，它的类型是什么？</p>
<p>type(df)</p>
<pre><code>pandas.core.frame.DataFrame
</code></pre><p>Recall that using the csv package before, every value was interpreted as a string. But how does Pandas interpret them using its own csv reader?<br>回想下从前使用csv包，每个值都翻译为一个字符串。但是Pandas如何使用自己的csv 阅读器翻译它们？</p>
<p> df.dtypes</p>
<pre><code>PassengerId  int64
Survived     int64
Pclass       int64
Name        object
Sex         object
Age        float64
SibSp        int64
Parch        int64
Ticket      object
Fare       float64
Cabin       object
Embarked    object
dtype: object
</code></pre><p>Pandas is able to infer numerical types whenever it can detect them. So we have values already stored as integers. When it detected the existing decimal points somewhere in Age and Fare, it converted those columns to float. There are two more very valuable commands to learn on a dataframe:<br>无论什么时候检测到数值类型，Pandas都能推断出来。所以我们的数值已经被保存为整型了。当它检测到年龄和票价中已存在的十进制小数点，它能把这些列转化为浮点型。在dataframe里有2个以上的值指令可以学习：</p>
<p> df.info()</p>
<pre><code>&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
Int64Index: 891 entries, 0 to 890
Data columns (total 12 columns):
PassengerId    891 non-null int64
Survived       891 non-null int64
Pclass         891 non-null int64
Name           891 non-null object
Sex            891 non-null object
Age            714 non-null float64
SibSp          891 non-null int64
Parch          891 non-null int64
Ticket         891 non-null object
Fare           891 non-null float64
Cabin          204 non-null object
Embarked       889 non-null object
dtypes: float64(2), int64(5), object(5)
</code></pre><p>There’s a lot of useful info there! You can see immediately we have 891 entries (rows), and for most of the variables we have complete values (891 are non-null). But not for Age, or Cabin, or Embarked – those have nulls somewhere. Now try:<br>这里有许多有用的信息！你能立刻看到我们有891个记录（行），并且对大多数变量，我们有完整的值（891就是没有缺损的）。但是对于年龄或者客舱，或者上船点，这些有很多空值。现在试下：</p>
<p> df.describe()</p>
<pre><code>     PassengerId    Survived      Pclass         Age  ...
count  891.000000  891.000000  891.000000  714.000000  ...
mean   446.000000    0.383838    2.308642   29.699118  ...
std    257.353842    0.486592    0.836071   14.526497  ...
min      1.000000    0.000000    1.000000    0.420000  ...
25%    223.500000    0.000000    2.000000   20.125000  ...
50%    446.000000    0.000000    3.000000   28.000000  ...
75%    668.500000    1.000000    3.000000   38.000000  ...
max    891.000000    1.000000    3.000000   80.000000  ...
</code></pre><p>This is also very useful: pandas has taken all of the numerical columns and quickly calculated the mean, std, minimum and maximum value. Convenient! But also a word of caution: we know there are a lot of missing values in Age, for example. How did pandas deal with that? It must have left out any nulls from the calculation. So if we start quoting the “average age on the Titanic” we need to caveat how we derived that number.<br>这同样非常有用：pandas带了所有的数值列，快速计算均值，标准差，最小最大值。多方便！但是有一个警告：我们指导这里有很多年龄的缺失值，例如，pandas如何应对这些问题？它一定从计算里忽略了这些空值。所以如果我们开始引用“Titanic的平均年龄”时，我们需要附加说明数值的来源。</p>
<p>Data Munging<br>Data绿豆？</p>
<p>One step in any data analysis is the data cleaning. Thankfully pandas makes things easier to filter, manipulate, drop out, fill in, transform and replace values inside the dataframe. Below we also learn the syntax that pandas allows for referring to specific columns.<br>在任意数据分析的中都有一步数据清洗。感谢pandas让过滤、处理、丢弃、填充、转换和替代在dataframe里变得容易。下面我们同样学习pandas关于具体列的语法。</p>
<p>Referencing and filtering<br>引用和过滤</p>
<p>Let’s acquire the first 10 rows of the Age column. In pandas this is<br>让我们要求前10行的年龄列，在pandas这是：</p>
<p>df[‘Age’][0:10]</p>
<pre><code>0 22
1 38
2 26
3 35
4 35
5 NaN
6 54
7 2
8 27
9 14
Name: Age, dtype: float64
</code></pre><p>–&gt; And try this alternative syntax:  df.Age[0:10]<br>试试这个另一个语法：</p>
<p>–&gt; Without counting indices, can you show the Cabin column now?<br>不数索引，你能显示客舱列吗？</p>
<p>Similar to before, let’s understand what kind of object is this. Type:<br>与从前一样，让我们了解下这个object的类型是什么，输入：</p>
<p> type(df[‘Age’])</p>
<pre><code>pandas.core.series.Series
</code></pre><p>A single column is neither an numpy array, nor a pandas dataframe – but rather a pandas-specific object called a data Series.<br>一单列既不是numpy数组，也不是pandas dataframe——而是一个pandas-specific object叫做data Series</p>
<p>At this point, we’d really like to get than mean value:<br>在这点，我们真正想要得到平均值：</p>
<p> df[‘Age’].mean()</p>
<pre><code>29.69911764705882
</code></pre><p>That matches what was reported in df.describe().<br>这个与df.describe()相匹配。</p>
<p>–&gt; See if you can obtain the .median of Age as well.<br>看看你是否能同样获得年龄的中位数。</p>
<p>The next thing we’d like to do is look at more specific subsets of the dataframe. Again pandas makes this very convenient to write. Pass it a [ list ] of the columns desired:<br>我们想做的下一件事是，查看dataframe更多具体子集。同样，pandas让这些变得易写。传给它一个所需列的【list】：</p>
<p> df[ [‘Sex’, ‘Pclass’, ‘Age’] ]</p>
<pre><code>  Sex    Pclass Age


0 male   3      22.0
1 female 1      38.0
2 female 3      26.0
3 female 1      35.0
4 male   3      35.0
5 male   3       NaN
  ...    ...    ...
  ...    ...    ...

[891 rows x 3 columns]
</code></pre><p>Filtering data is another important tool if we are investigating the data by hand. The .describe() command had indicated that the maximum age was 80. What do the older passengers look like in this data set? This is written by passing the criteria of df as a where clause into df:<br>过滤数据是另一个重要的方法，如果我们想要手动调查数据。.describe()指令表示最大年龄是80. 老年乘客在数据集里是什么样子的呢？这可以通过把df的标准当作一个where从句传递给df写下来。</p>
<pre><code> df[df[&apos;Age&apos;] &gt; 60]

(a medium list of stuff!)
...
...
22 rows × 12 columns
</code></pre><p>If you were most interested in the mix of the gender and Passenger class of these older people, you would want to combine the two skills you just learned and get only a few columns for the same where filter:<br>如果你对这些老年人的性别和乘客类别的组合感兴趣，你将想要结合这两个刚学到的技能，获得几列同样的where过滤器：</p>
<p> df[df[‘Age’] &gt; 60][[‘Sex’, ‘Pclass’, ‘Age’, ‘Survived’]]</p>
<pre><code>    Sex    Pclass Age   Survived
33  male   2      66.0  0
54  male   1      65.0  0
96  male   1      71.0  0
116 male   3      70.5  0
170 male   1      61.0  0
252 male   1      62.0  0
275 female 1      63.0  1
280 male   3      65.0  0
...    ...    ...   ...
...    ...    ...   ...
[22 rows x 4 columns]
</code></pre><p>From visual examination of all 22 cases, it seems they were mostly men, mostly(?) 1st class, and mostly perished.<br>从可视化的所有22个考试题中，看起来，他们更多的是男人、一等，死亡。</p>
<p>Now it’s time to investigate all of those missing Age values, because we will need to address them in our model if we hope to use all the data for more advanced algorithms. To filter for missing values, use<br>现在是时候调查所有这些缺失的年龄值了。因为如果希望为更先进的算法使用所有的数据，我们将需要在模型里强调它们。。为了过滤缺失值，使用：</p>
<p> df[df[‘Age’].isnull()][[‘Sex’, ‘Pclass’, ‘Age’]]</p>
<pre><code>(a long list of stuff!)
...
...
...
177 rows × 3 columns
</code></pre><p>Here the only thing we did was print all 177 cases, but the same syntax can be used later if we take action on them.<br>这里我们唯一做的东西就是打印出所有177条记录。但是如果我们在上面操作，也可以使用同样的语法。</p>
<p>It will also be useful to combine multiple criteria (joined by the syntax &amp;). To practice even more functionality in the same line of code, let’s take a count of the males in each class.<br>结合多重标准（用&amp;）也很有用。为练习同一样代码的更多功能，让我们拿一个男性的count到每个类中。</p>
<pre><code>for i in range(1,4):
    print i, len(df[ (df[&apos;Sex&apos;] == &apos;male&apos;) &amp; (df[&apos;Pclass&apos;] == i) ])
1 122
2 108
3 347
</code></pre><p>Before we finish the initial investigation by hand, let’s use one other convenience function of pandas to derive a histogram of any numerical column. The histogram function is really a shortcut to the more powerful features of the matplotlib/pylab packages, so let’s be sure that’s imported. Type the following:<br>在我们结束最初的手工研究之前，让我们使用pandas里另一个方便的功能来获得任意数值列的直方图。这个直方图功能其实是到matplotlib/pylab包更有力的特征一个捷径，所以让我们确认那是导入的，输入下面的：</p>
<pre><code>import pylab as P
df[&apos;Age&apos;].hist()
P.show()
</code></pre><p>histogram output 1</p>
<p>Inside the parentheses of .hist(), you can also be more explicit about options of this function. Before you invoke it, you can also be explicit that you are dropping the missing values of Age:<br>在 .hist()的圆括号里，你也能更明确这个功能的选项。在你调用它之前，你也可以具体化为，你在丢弃年龄缺失值：</p>
<pre><code>df[&apos;Age&apos;].dropna().hist(bins=16, range=(0,80), alpha = .5)
P.show()
</code></pre><p>histogram output 2</p>
<p>Cleaning the data<br>数据清洗</p>
<p>Ok now that we are comfortable with the syntax, we are ready to begin transforming the values in the dataframe into the shape we need for machine learning. First of all, it’s hard to run analysis on the string values of “male” and “female”. Let’s practice transforming it in three ways – twice for fun and once to make it useful. We’ll store our transformation in a new column, so the original Sex isn’t changed.<br>既然我们了解了语法，我们准备好把dataframe里的数值转化为机器学习的形状。首先，对于字符型“male”和“female”很难运行分析。让我们练习三种转换方式——2次是好玩，1次有用。我们将把转换值存储一个新列，这样原始性别就不会改变了。</p>
<p>In Pandas, adding a column is as easy as naming it and passing it new values.<br>在Pandas，增加一列跟重命名和传递新值一样简单。</p>
<pre><code>df[&apos;Gender&apos;] = 4
</code></pre><p>Show some .head() rows of the dataframe to see what we just accomplished. Well, now let’s make it mean something that’s actually derived from the Sex column.<br>显示dataframe的一些.head()行，来看看我们完成了什么。让我们给这个实际从性别列得来的东西赋予意义。</p>
<pre><code>df[&apos;Gender&apos;] = df[&apos;Sex&apos;].map( lambda x: x[0].upper() )
</code></pre><p>Iambda x is an built-in function of python for generating an anonymous function in the moment, at runtime. Remember that x[0] of any string returns its first character.<br>Iambda x是一个python的内置函数，产生运行当前时间的一个匿名函数。记住任何字符的x[0]都返回它的第一个字符。</p>
<p>What do the .head() rows of the dataframe look like now?<br>dataframe的.head() 行长什么样？</p>
<p>But of course what we really need is a binary integer for female and male, similar to the way Survived is stored. As a matter of consistency, let’s also make Gender into values of 0 and 1’s. We have a precedent of analyzing the women first in all of our previous arrays, so let’s decide female = 0 and male = 1.  So, for real this time:<br>但是当然我们实际需要的是一个femal和male的二进制整数，类似于Survived存储方式。作为连续性因素，让我们也把Gender变为0和1.我们有在前面数组分析女性的先例，所以可以让femal=0，male=1. 这样，实际上：</p>
<pre><code>df[&apos;Gender&apos;] = df[&apos;Sex&apos;].map( {&apos;female&apos;: 0, &apos;male&apos;: 1} ).astype(int)
</code></pre><p>See what the .head() rows of the dataframe look like now.<br>现在看看dataframe的.head() 行长什么样。</p>
<p>–&gt; Can you make a new column to do something similar for the Embarked values?<br>你能对the Embarked值制作一个新的列来做点类似的事情吗？</p>
<p>Now it’s time to deal with the missing values of Age, because most machine learning will need a complete set of values in that column to use it. By filling it in with guesses, we’ll be introducing some noise into a model, but if we can keep our guesses reasonable, some of them should be close to the historical truth (whatever it was…), and the overall predictive power of Age might still make a better model than before.  We know the average [known] age of all passengers is 29.6991176 – we could fill in the null values with that. But maybe the median would be better? (to reduce the influence of a few rare 70- and 80-year olds?) The Age histogram did seem positively skewed. These are the kind of decisions you make as you create your models in a Kaggle competition.<br>现在是时候对付年龄的缺失值了。因为大多数机器学习将需要一个完成的列值集合来使用。通过猜数填充，我们将介绍一些噪声到一个模型中。但如果我们能保持我们猜测得合理，一些将与历史的真实接近。年龄的总体预测能力将生成一个比过去更好的模型。我们知道已知平均年龄是29.6991176——我们能把它填充到空值中去。但也许中位值更好？（为了降低一些极少70-和80-多岁人的影响？）年龄直方图确实看起来正偏。这些就是你在Kaggle竞赛中创建自己模型时需要做的决定。</p>
<p>For now let’s decide to be more sophisticated, that we want to use the age that was typical in each passenger class. And decide that the median might be better. Let’s build another reference table to calculate what each of these medians are:<br>从现在开始让我们更复杂一点。我们想用每个乘客等级里最典型的年龄。决定那个中值更好。让我们建立另一个参考表格来计算每个中值的值。</p>
<pre><code>median_ages = np.zeros((2,3))
median_ages
</code></pre><p>yields:</p>
<pre><code>array([[ 0., 0., 0.],
   [ 0., 0., 0.]])
</code></pre><p>And then populating the array,</p>
<pre><code>for i in range(0, 2):
    for j in range(0, 3):
        median_ages[i,j] = df[(df[&apos;Gender&apos;] == i) &amp; \
                              (df[&apos;Pclass&apos;] == j+1)][&apos;Age&apos;].dropna().median()

median_ages
</code></pre><p>yields:</p>
<pre><code>array([[ 35. , 28. , 21.5],
       [ 40. , 30. , 25. ]])
</code></pre><p>We could fill in the missing ages directly into the Age column. But to be extra cautious and not lose the state of the original data, a more formal way would be to create a new column, AgeFill, and even record which ones were originally null (and thus artificially guessed).<br>我们能直接把这些缺失年龄值填入到年龄列。但是为了谨慎期间，不丢失原始数据的状态，一个更加正式的方式是创建新列，AgeFill，甚至记录哪些是原始空值（因此人工猜测）。</p>
<p>Make a copy of Age:<br>复制Age列：</p>
<pre><code>df[&apos;AgeFill&apos;] = df[&apos;Age&apos;]

df.head()
</code></pre><p>Take a look at just the rows with missing values, and limit it to the columns important to us right now:<br>看看那些有缺失值的列，把它限制到现在对我们重要的列里：</p>
<pre><code>df[ df[&apos;Age&apos;].isnull() ][[&apos;Gender&apos;,&apos;Pclass&apos;,&apos;Age&apos;,&apos;AgeFill&apos;]].head(10)
   Gender Pclass Age AgeFill
5  1      3      NaN     NaN
17 1      2      NaN     NaN
19 0      3      NaN     NaN
26 1      3      NaN     NaN
28 0      3      NaN     NaN
29 1      3      NaN     NaN
31 0      1      NaN     NaN
32 0      3      NaN     NaN
36 1      3      NaN     NaN
42 1      3      NaN     NaN
</code></pre><p>Use some code to fill in AgeFill based on our median_ages table. Here we happen to use the alternate syntax for referring to an existing column, like df.Age rather than df[‘Age’].  There’s a where clause on df and referencing its column AgeFill, then assigning it an appropriate value out of median_ages.<br>基于我们的median_ages表格，使用一些代码，填充到AgeFill里。这里我们碰巧参照现有列使用alternate语法，比如df.Age而非df[‘Age’]。这里有一个where从句在df和参考它的列AgeFill，然后在median_ages里分配给它一个合适值。</p>
<pre><code>for i in range(0, 2):
    for j in range(0, 3):
        df.loc[ (df.Age.isnull()) &amp; (df.Gender == i) &amp; (df.Pclass == j+1),\
                &apos;AgeFill&apos;] = median_ages[i,j]
</code></pre><p>View the exact same 10 rows we just looked at:<br>查看我们刚才看的同样的10行，</p>
<pre><code>df[ df[&apos;Age&apos;].isnull() ][[&apos;Gender&apos;,&apos;Pclass&apos;,&apos;Age&apos;,&apos;AgeFill&apos;]].head(10)
   Gender Pclass Age AgeFill
5  1      3      NaN    25.0
17 1      2      NaN    30.0
19 0      3      NaN    21.5
26 1      3      NaN    25.0
28 0      3      NaN    21.5
29 1      3      NaN    25.0
31 0      1      NaN    35.0
32 0      3      NaN    21.5
36 1      3      NaN    25.0
42 1      3      NaN    25.0
</code></pre><p>This confirms we accomplished exactly what we wanted.<br>这确认了我们达成了预期。</p>
<p>Let’s also create a feature that records whether the Age was originally missing. This is relatively simple by allowing pandas to use the integer conversion of the True/False evaluation of its built-in function, pandas.isnull()<br>让我们同样创建一个特征值，记录年龄列是否原始缺失。这相对简单。可以通过允许pandas使用内置函数pandas.isnull()的True/False估计的整数变换。</p>
<pre><code>df[&apos;AgeIsNull&apos;] = pd.isnull(df.Age).astype(int)
</code></pre><p>Now that we have 3 new numerical columns, Gender, AgeFill, AgeIsNull… perhaps you want to run df.describe() to see the summary statistics of the whole dataframe again.<br>既然我们有了3个新数值列，Gender，AgeFill，AgeIsNull，也许你想运行df.describe()再看看dataframe的总统计。</p>
<p>Feature Engineering<br>特征工程</p>
<p>Let’s create a couple of other features, this time using simple math on existing columns. Since we know that Parch is the number of parents or children onboard, and SibSp is the number of siblings or spouses, we could collect those together as a FamilySize:<br>让我们创建几个其他特征。这次在已存在列上使用简单数学。因为我们知道Parch是船上父母或者儿童的数量，SibSp是兄弟姐妹或者配偶的数量，我们能收集这些作为一个家庭规模。</p>
<pre><code>df[&apos;FamilySize&apos;] = df[&apos;SibSp&apos;] + df[&apos;Parch&apos;]
</code></pre><p>We can also create artificial features if we think it may be advantageous to a machine learning algorithm – of course, it might not. For example, we know Pclass had a large effect on survival, and it’s possible Age will too. One artificial feature could incorporate whatever predictive power might be available from both Age and Pclass by multiplying them. This amplifies 3rd class (3 is a higher multiplier) at the same time it amplifies older ages. Both of these were less likely to survive, so in theory this could be useful.<br>我们能创建人工特征，如果我们认为它也许对于机器学习算法有好处。当然，它也许没有。例如，我们知道Pclass对存活有一个很大的作用，Age也可能是。无论什么预测能力从Age乘以Pclass中获得，这个人工特征都不恰当。它放大了第三等级（3是一个高乘数），同时也放大了老龄。这两者都更不容易存活，所以理论上它应当是有用的。</p>
<pre><code>df[&apos;Age*Class&apos;] = df.AgeFill * df.Pclass
</code></pre><p>We could make some histograms of our new columns to understand them better. Go back and find the .hist() commands above.<br>我们能做一些新列的直方图来更好地理解它们。回去找到.hist()指令。</p>
<p>We know we’d like to have better predictive power for the men, so you might be wishing you could pull out more information from the Name column – for example the honorary or pedestrian title of the men? We won’t accomplish that in this tutorial, but you may find ideas in the Kaggle forums.<br>我们知道我们最好对男人有更好的预测能力。这样你也许希望你能从姓名列拉出更多的信息，比如，男性中有荣誉的头衔或者平凡的头衔，我们不会在这篇教程里完成，但是也许你能在Kaggle论坛里找到一些启发。</p>
<p>Final preparation<br>最后准备</p>
<p>We have our data almost ready for machine learning. But most basic ML techniques will not work on strings, and in python they almost always require the data to be an array– the implementations we will see in the sklearn package are not written to use a pandas dataframe. So the last two things we need to do are (1) determine what columns we have left which are not numeric, and (2) send our pandas.DataFrame back to a numpy.array.<br>我们已经为机器学习准备了数据。但是大多数基本的ML技术不会在字符型上工作。python里他们几乎总是需要数据变为数组。sklearn包里的实施，不会被写到使用pandas dataframe。所以最后两件事我们需要做的是（1）决定什么非数值列我们已经丢下了；（2）把我们的pandas.DataFrame发回到a numpy.array。</p>
<p>In pandas you could always see the column types from the .info() method. You can also see them directly:<br>在pandas你能用.info()方法看到列类型，你也可以直接看：</p>
<pre><code>df.dtypes
PassengerId   int64
Survived      int64
Pclass        int64
Name         object
Sex          object
Age         float64
SibSp         int64
Parch         int64
Ticket       object
Fare        float64
Cabin        object
Embarked     object
Gender        int64
AgeFill     float64
AgeIsNull     int64
FamilySize    int64
Age*Class   float64
dtype: object
</code></pre><p>With a little manipulation, we can require .dtypes to show only the columns which are ‘object’, which for pandas means it has strings:<br>做一点改动，我们需要.dtypes 来显示’object’的列。对pandas来说它有字符。</p>
<pre><code>df.dtypes[df.dtypes.map(lambda x: x==&apos;object&apos;)]
Name        object
Sex         object
Ticket      object
Cabin       object
Embarked    object
dtype: object
</code></pre><p>(You may already have already transformed ‘Embarked’ in your own work above.)<br>你可能已经在上面的工作中已经把’Embarked’转换过了。</p>
<p>The next step is to drop the columns which we will not use:<br>下一步是丢下我们不用的列：</p>
<pre><code>df = df.drop([&apos;Name&apos;, &apos;Sex&apos;, &apos;Ticket&apos;, &apos;Cabin&apos;, &apos;Embarked&apos;], axis=1)
</code></pre><p>We can also drop ‘Age’ even though it is numeric, since we copied and filled that to a better column AgeFill. The original ‘Age’ still has the missing values which won’t work well in our future model.<br>我们已经丢下了Age列，尽管它是数值。因为我们复制和填充了一个更好的列AgeFill。原始Age列仍然有缺失值，它在我们未来的模型中不能好好工作。</p>
<pre><code>df = df.drop([&apos;Age&apos;], axis=1)
</code></pre><p>An alternate command is to drop any rows which still have missing values:<br>一个alternate命令式，丢弃有缺失值的任意行，</p>
<pre><code>df = df.dropna()
</code></pre><p>But remember that .dropna() removes an observation from df even if it only has 1 NaN, anywhere, in any of its columns. It could delete most of your dataset if you aren’t careful with the state of missing values in other columns!<br>但是记住.dropna() 去除了任何地方任何列的一个observation from df，即使只有一个NaN。它会删除你数据集里的大多数东西，如果你不小心注意其他列的缺失值。</p>
<p>Now we have a clean and tidy dataset that is ready for analysis.<br>现在我们有了一个清楚干净的数据集，可以分析了。</p>
<p>The final step is to convert it into a Numpy array. Pandas can always send back an array using the .values method. Assign to a new variable, train_data:<br>最后一步是把它转换为Numpy数组。Pandas能使用.values方法返回一个数组。布置一个新变量，train_data:</p>
<pre><code>train_data = df.values
train_data
array([[ 1. , 0. , 3. , ..., 0. , 1. , 66. ],
       [ 2. , 1. , 1. , ..., 0. , 1. , 38. ],
       [ 3. , 1. , 3. , ..., 0. , 0. , 78. ],
       ...,
       [ 889. , 0. , 3. , ..., 1. , 3. , 64.5],
       [ 890. , 1. , 1. , ..., 0. , 0. , 26. ],
       [ 891. , 0. , 3. , ..., 0. , 0. , 96. ]])
</code></pre><p>Compare that to the original array we used in the last tutorial! Type:<br>把那与我们在最后教程里的原始数组相比较！输入：</p>
<pre><code>data
 array([[&apos;1&apos; &apos;0&apos; &apos;3&apos; ..., &apos;7.25&apos; &apos;&apos; &apos;S&apos;]
        [&apos;2&apos; &apos;1&apos; &apos;1&apos; ..., &apos;71.2833&apos; &apos;C85&apos; &apos;C&apos;]
        [&apos;3&apos; &apos;1&apos; &apos;3&apos; ..., &apos;7.925&apos; &apos;&apos; &apos;S&apos;]
        ...,
        [&apos;889&apos; &apos;0&apos; &apos;3&apos; ..., &apos;23.45&apos; &apos;&apos; &apos;S&apos;]
        [&apos;890&apos; &apos;1&apos; &apos;1&apos; ..., &apos;30&apos; &apos;C148&apos; &apos;C&apos;]
        [&apos;891&apos; &apos;0&apos; &apos;3&apos; ..., &apos;7.75&apos; &apos;&apos; &apos;Q&apos;]],
      dtype=&apos;|S82&apos;)
</code></pre><p>Conclusion<br>结论</p>
<p>Here we used Pandas as a much easier tool to access the data in a csv file and manipulate it.<br>这里我们使用Pandas作为一个更容易的工具来获取csv文件的数据并处理它。</p>
<p>If you found this tutorial helpful but would like more practice, you could re-do the previous Python tutorial, but this time write your script using pandas. (In fact, one Kaggler did just that in the forums. At the very least, you should be able to read and understand his script.)<br>如果你发现这些教程有用，但希望更实用。你可以重新做之前教程，但是这次实用pandas写下你的脚本。（实际上，一个Kaggler在论坛里就是这样做的。至少，你应当能够读和理解他的脚本。）</p>
<p>In the next tutorial we will take advantage of your new skills with python, in order to apply Machine Learning on this data for the first time.<br>在下一个教程里，我们将利用你的python新技能，为了第一次在这个data上应用机器学习。</p>

      
    </div>

    <div>
      
        
<div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/uploads/wechat-qcode.jpg" alt="dumpling001 wechat" style="width: 200px; max-width: 100%;"/>
    <div>我的微信公众号二维码，写点滴思考，与编程无关。</div>
</div>


      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/10/26/翻译-Getting-Started-With-Python/" rel="next" title="翻译 | Getting Started With Python">
                <i class="fa fa-chevron-left"></i> 翻译 | Getting Started With Python
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/10/28/翻译-Getting-Started-With-Excel/" rel="prev" title="翻译 | Getting Started With Excel">
                翻译 | Getting Started With Excel <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/10/27/翻译-Getting-Started-With-Python-II/"
           data-title="翻译 | Getting Started With Python II" data-url="http://yoursite.com/2016/10/27/翻译-Getting-Started-With-Python-II/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="dumpling001" />
          <p class="site-author-name" itemprop="name">dumpling001</p>
          <p class="site-description motion-element" itemprop="description">Java, Python, 编写未来新生活</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">43</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://hexo.io/zh-cn/docs/" title="Hexo" target="_blank">Hexo</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.youtube.com/watch?v=SFas42HBtMg" title="Python Crawler Tutorial" target="_blank">Python Crawler Tutorial</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/TankXiao/" title="资深软件测试员" target="_blank">资深软件测试员</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://cuiqingcai.com/1052.html" title="python爬虫教程" target="_blank">python爬虫教程</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://blueseach.github.io/" title="游遍星辰" target="_blank">游遍星辰</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://chayangge.com/" title="插秧哥" target="_blank">插秧哥</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://xiaolai.li/" title="Reborn" target="_blank">Reborn</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://qixinbo.info/" title="亓欣波" target="_blank">亓欣波</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://sunwhut.com/2015/10/30/buildBlog/" title="Sunwhut" target="_blank">Sunwhut</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <p class="post-toc-empty">此文章未包含目录</p>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">dumpling001</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"programlife"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  

</body>
</html>
